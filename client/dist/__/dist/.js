parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"DNXt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OT=void 0;class s{constructor(s,t,r){this.inclusionTransform=s,this.exclusionTransform=t,this.siteID=r,this.historyBuffer=[],this.idHistory=[]}static operationsAreIndependent(s,t){for(const r of s.historyBuffer)if(r===t.id)return!1;return!0}addToHistory(s){this.historyBuffer.push(s),this.idHistory.push(s.id)}history(){return this.idHistory}transpose(s,t){const r=this.exclusionTransform(t,s);return[r,this.inclusionTransform(s,r)]}listTranspose(s,t){const r=this.historyBuffer;for(let i=t;i>s;i-=1){const s=this.transpose(r[i-1],r[i]);[r[i-1],r[i]]=s}}listInclusionTransform(s,t){let r=s;for(let i=t;i<this.historyBuffer.length;i+=1){const s=this.historyBuffer[i];r=this.inclusionTransform(r,s)}return r}goto(t){let r=-1;for(let e=0;e<this.historyBuffer.length;e+=1)if(s.operationsAreIndependent(t,this.historyBuffer[e])){r=e;break}if(-1===r)return t;const i=[];for(let e=r+1;e<this.historyBuffer.length;e+=1)s.operationsAreIndependent(t,this.historyBuffer[e])||i.push(e);if(0===i.length)return this.listInclusionTransform(t,r);const o=i.length;for(let s=0;s<o;s+=1)this.listTranspose(r+s,i[s]);return this.listInclusionTransform(t,r+o)}}exports.OT=s;
},{}],"UhOi":[function(require,module,exports) {
"use strict";var i;Object.defineProperty(exports,"__esModule",{value:!0}),exports.inclusionTransform=n,exports.exclusionTransform=e,exports.serialize=r,exports.deserialize=f,exports.Delete=exports.Insert=exports.Operation=exports.OperationType=void 0,exports.OperationType=i,function(i){i.DELETE="d",i.INSERT="i"}(i||(exports.OperationType=i={}));class o{constructor(i,o,t,s,n,e){this.type=i,this.position=o,this.id=t,this.siteID=s,this.historyBuffer=n,this.isNoop=e,this.auxPos=o}}exports.Operation=o;class t extends o{constructor(o,t,s,n,e,r=!1){super(i.INSERT,t,s,n,e,r),this.char=o}}exports.Insert=t;class s extends o{constructor(o,t,s,n,e=!1){super(i.DELETE,o,t,s,n,e)}}function n(i,o){if(i.isNoop)return i instanceof s&&o instanceof t&&i.position===o.position?new s(i.position,i.id,i.siteID,i.historyBuffer):i;if(o.isNoop)return i instanceof t&&o instanceof s&&i.position===o.auxPos?new t(i.char,i.position,i.id,i.siteID,i.historyBuffer,!0):i;if(i instanceof t&&o instanceof t){if(i.position<o.position||i.position===o.position&&i.siteID<=o.siteID)return new t(i.char,i.auxPos,i.id,i.siteID,i.historyBuffer);const s=Math.min(i.position,i.auxPos)+1;return new t(i.char,s,i.id,i.siteID,i.historyBuffer)}if(i instanceof t&&o instanceof s){if(i.position<=o.position)return i;const s=new t(i.char,i.position-1,i.id,i.siteID,i.historyBuffer);return s.auxPos=i.position,s}if(i instanceof s&&o instanceof t)return i.position<o.position?i:new s(i.position+1,i.id,i.siteID,i.historyBuffer);if(i instanceof s&&o instanceof s){if(i.position===o.position)return new s(i.position,i.id,i.siteID,i.historyBuffer,!0);if(i.position<o.position)return i;const t=new s(i.position-1,i.id,i.siteID,i.historyBuffer);return t.auxPos=i.position,t}return i}function e(i,o){if(i.isNoop){if(o.isNoop&&i.position===o.position&&i instanceof t&&o instanceof s)return new t(i.char,i.position,i.id,i.siteID,i.historyBuffer);if(i.position===o.position&&i instanceof s&&o instanceof s)return new s(i.position,i.id,i.siteID,i.historyBuffer);if(i instanceof s&&o instanceof t){const o=new s(i.position,i.id,i.siteID,i.historyBuffer,!0);return o.auxPos=-1,o}return i}if(o.isNoop)return i;if(i instanceof t&&o instanceof t){if(i.position===o.position&&i.siteID>o.siteID){const o=new t(i.char,i.position,i.id,i.siteID,i.historyBuffer);return o.auxPos=i.position-1,o}if(i.position<=o.position)return o.auxPos=o.position+1,i;const s=new t(i.char,i.position-1,i.id,i.siteID,i.historyBuffer);return i.siteID<o.siteID&&(s.auxPos=i.position),s}return i instanceof t&&o instanceof s?i.position===o.position?new t(i.char,i.auxPos,i.id,i.siteID,i.historyBuffer):i.position<o.position?i:new t(i.char,i.position+1,i.id,i.siteID,i.historyBuffer):i instanceof s&&o instanceof t?i.position===o.position?new s(i.position,i.id,i.siteID,i.historyBuffer,!0):i.position<o.position?i:new s(i.position-1,i.id,i.siteID,i.historyBuffer):i instanceof s&&o instanceof s?i.position>=o.position?new s(i.position+1,i.id,i.siteID,i.historyBuffer):new s(i.position,i.id,i.siteID,i.historyBuffer):i}function r(i){const{historyBuffer:o,id:s,type:n,position:e,siteID:r}=i,f={historyBuffer:o,id:s,type:n,position:e,siteID:r};return i instanceof t&&(f.char=i.char),f}function f(o){return o.type===i.INSERT?new t(o.char,o.position,o.id,o.siteID,o.historyBuffer):new s(o.position,o.id,o.siteID,o.historyBuffer)}exports.Delete=s;
},{}],"yQwy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"OT",{enumerable:!0,get:function(){return e.OT}}),exports.charwise=void 0;var e=require("./control"),r=require("./charwise");const i={Delete:r.Delete,Insert:r.Insert,Operation:r.Operation,OperationType:r.OperationType,deserialize:r.deserialize,exclusionTransform:r.exclusionTransform,inclusionTransform:r.inclusionTransform,serialize:r.serialize};exports.charwise=i;
},{"./control":"DNXt","./charwise":"UhOi"}],"DILy":[function(require,module,exports) {
"use strict";function e(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=n(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a,i=!0,c=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==o.return||o.return()}finally{if(c)throw a}}}}function n(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var r=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(n){a(n)}}function c(e){try{u(r.throw(e))}catch(n){a(n)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(i,c)}u((r=r.apply(e,n||[])).next())})};function o(n){var t=this,o=document.createElement("div");o.className="modal__bg";var a=document.createElement("div");a.className="modal__root",o.appendChild(a);var i=document.createElement("h1");i.className="modal__head",i.innerHTML=n.title,a.appendChild(i);var c,u=e(n.body);try{for(u.s();!(c=u.n()).done;){var l=c.value,d=document.createElement("p");d.className="modal__p",d.innerHTML=l,a.appendChild(d)}}catch(m){u.e(m)}finally{u.f()}if(n.confirm){var f=document.createElement("button");f.className="modal__confirm",f.innerHTML=n.confirm,f.addEventListener("click",function(){return r(t,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.onConfirm();case 2:document.body.removeChild(a),document.body.removeChild(o);case 4:case"end":return e.stop()}},e)}))}),a.appendChild(f)}return document.body.appendChild(o),o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=o;
},{}],"yvdU":[function(require,module,exports) {
"use strict";function t(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=e(t))){var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i,a=!0,u=!1;return{s:function(){o=t[Symbol.iterator]()},n:function(){var t=o.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==o.return||o.return()}finally{if(u)throw i}}}}function e(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(e){i(e)}}function u(t){try{c(r.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,u)}c((r=r.apply(t,e||[])).next())})},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var i=o(require("./modal"));function a(){var e,n=t(document.body.children);try{for(n.s();!(e=n.n()).done;){var r=e.value;document.body.removeChild(r)}}catch(o){n.e(o)}finally{n.f()}i.default({title:"Error!",body:["Something unexpected went wrong!","You can try refreshing the page to fix it."]})}function u(t){return r(this,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.default({title:"Lost connection!",body:["Attempting to reconnect..."]}),e.next=3,t;case 3:document.body.removeChild(n);case 4:case"end":return e.stop()}},e)}))}exports.fatalError=a,exports.networkError=u;
},{"./modal":"DILy"}],"bkb9":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(i,o){function l(e){try{n(a.next(e))}catch(t){o(t)}}function s(e){try{n(a.throw(e))}catch(t){o(t)}}function n(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(l,s)}n((a=a.apply(e,t||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});var t=require("@rclarey/simple-ot"),r=require("./error"),a="ws://localhost:8080",i=[["APL","apl"],["ASN.1","asn.1"],["Asterisk dialplan","asterisk"],["Brainfuck","brainfuck"],["C, C++, C#","clike"],["Ceylon","clike"],["Clojure","clojure"],["Closure Stylesheets (GSS)","css/gss.html"],["CMake","cmake"],["COBOL","cobol"],["CoffeeScript","coffeescript"],["Common Lisp","commonlisp"],["Crystal","crystal"],["CSS","css"],["Cypher","cypher"],["Cython","python"],["D","d"],["Dart","dart"],["Django (templating language)","django"],["Dockerfile","dockerfile"],["diff","diff"],["DTD","dtd"],["Dylan","dylan"],["EBNF","ebnf"],["ECL","ecl"],["Eiffel","eiffel"],["Elm","elm"],["Erlang","erlang"],["Factor","factor"],["FCL","fcl"],["Forth","forth"],["Fortran","fortran"],["F#","mllike"],["Gas (AT&T-style assembly)","gas"],["Gherkin","gherkin"],["Go","go"],["Groovy","groovy"],["HAML","haml"],["Handlebars","handlebars"],["Haskell","haskell"],["Haskell (Literate)","haskell-literate"],["Haxe","haxe"],["HTML embedded","htmlembedded"],["HTML mixed-mode","htmlmixed"],["HTTP","http"],["IDL","idl"],["Java","clike"],["JavaScript","javascript"],["JSX","jsx"],["Jinja2","jinja2"],["Julia","julia"],["Kotlin","clike"],["LESS","css"],["LiveScript","livescript"],["Lua","lua"],["Markdown","markdown"],["Markdown (GitHub-flavour)","gfm"],["Mathematica","mathematica"],["mbox","mbox"],["mIRC","mirc"],["Modelica","modelica"],["MscGen","mscgen"],["MUMPS","mumps"],["Nginx","nginx"],["NSIS","nsis"],["N-Triples/N-Quads","ntriples"],["Objective C","clike"],["OCaml","mllike"],["Octave","octave"],["Oz","oz"],["Pascal","pascal"],["PEG.js","pegjs"],["Perl","perl"],["PGP (ASCII armor)","asciiarmor"],["PHP","php"],["Pig Latin","pig"],["PowerShell","powershell"],["Properties files","properties"],["ProtoBuf","protobuf"],["Pug","pug"],["Puppet","puppet"],["Python","python"],["Q","q"],["R","r"],["RPM","rpm"],["reStructuredText","rst"],["Ruby","ruby"],["Rust","rust"],["SAS","sas"],["Sass","sass"],["Spreadsheet","spreadsheet"],["Scala","clike"],["Scheme","scheme"],["SCSS","css"],["Shell","shell"],["Sieve","sieve"],["Slim","slim"],["Smalltalk","smalltalk"],["Smarty","smarty"],["Solr","solr"],["Soy","soy"],["Stylus","stylus"],["SQL","sql"],["SPARQL","sparql"],["Squirrel","clike"],["Swift","swift"],["sTeX, LaTeX","stex"],["Tcl","tcl"],["Textile","textile"],["Tiddlywiki","tiddlywiki"],["Tiki wiki","tiki"],["TOML","toml"],["Tornado","tornado"],["troff","troff"],["TTCN","ttcn"],["TTCN Configuration","ttcn-cfg"],["Turtle","turtle"],["Twig","twig"],["VB.NET","vb"],["VBScript","vbscript"],["Velocity","velocity"],["Verilog/SystemVerilog","verilog"],["VHDL","vhdl"],["Vue.js app","vue"],["Web IDL","webidl"],["XML/HTML","xml"],["XQuery","xquery"],["Yacas","yacas"],["YAML","yaml"],["YAML frontmatter","yaml-frontmatter"],["Z80","z80"]];function o(e){var t="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.53.2/mode/".concat(e,"/").concat(e,".min.js");if(!document.querySelector('script[src="'.concat(t,'"]'))){var r=document.createElement("script");r.src=t,document.body.appendChild(r)}}function l(e){}function s(e,r,a,i,o){var l=CodeMirror(e,{value:i,mode:o,theme:"nord"});return l.on("change",function(e,t){console.log(e,t),r.send("a")}),new t.OT(t.charwise.inclusionTransform,t.charwise.exclusionTransform,a).history(),l}function n(t){return e(this,void 0,void 0,regeneratorRuntime.mark(function e(){var i,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:document.createElement("div").className="topbar",(i=document.createElement("div")).className="editor__root",(l=new WebSocket(a)).onopen=function(){return l.send(JSON.stringify({type:"init",id:t}))},l.onmessage=function(e){try{var t=JSON.parse(e.data);"ack"!==t.type?(l.close(),r.fatalError()):(o(t.mode),s(i,l,t.siteId,t.value,t.mode))}catch(a){l.close(),r.fatalError()}};case 7:case"end":return e.stop()}},e)}))}exports.default=n;
},{"@rclarey/simple-ot":"yQwy","./error":"yvdU"}],"BHXf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";function r(){for(var r="",t=12;t--;)r+=e[64*Math.random()|0];return r}exports.genId=r;
},{}],"ZCfc":[function(require,module,exports) {
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(r,o){e=function(t,e){return new l(t,void 0,e)};var i=u(RegExp),c=RegExp.prototype,a=new WeakMap;function l(t,e,n){var r=i.call(this,t,e);return a.set(r,n||a.get(t)),r}function f(t,e){var n=a.get(e);return Object.keys(n).reduce(function(e,r){return e[r]=t[n[r]],e},Object.create(null))}return n(l,i),l.prototype.exec=function(t){var e=c.exec.call(this,t);return e&&(e.groups=f(e,this)),e},l.prototype[Symbol.replace]=function(e,n){if("string"==typeof n){var r=a.get(this);return c[Symbol.replace].call(this,e,n.replace(/\$<([^>]+)>/g,function(t,e){return"$"+r[e]}))}if("function"==typeof n){var o=this;return c[Symbol.replace].call(this,e,function(){var e=[];return e.push.apply(e,arguments),"object"!==t(e[e.length-1])&&e.push(f(e,o)),n.apply(this,e)})}return c[Symbol.replace].call(this,e,n)},e.apply(this,arguments)}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}function r(e,n){return!n||"object"!==t(n)&&"function"!=typeof n?o(e):n}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){var e="function"==typeof Map?new Map:void 0;return(u=function(t){if(null===t||!a(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return i(t,arguments,f(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,t)})(t)}function i(t,e,n){return(i=c()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&l(o,n.prototype),o}).apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function a(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,u){function i(t){try{a(r.next(t))}catch(e){u(e)}}function c(t){try{a(r.throw(t))}catch(e){u(e)}}function a(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(i,c)}a((r=r.apply(t,e||[])).next())})},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});var y=s(require("./editor")),d=s(require("./modal")),h=require("./util");function b(){var t,n,r;return null!==(r=null===(n=null===(t=e(/\?doc=([\0-%'-\uFFFF]*)/,{id:1}).exec(location.search))||void 0===t?void 0:t.groups)||void 0===n?void 0:n.id)&&void 0!==r?r:null}function m(){var t=this,e=b();e?y.default(e):d.default({title:"Welcome!",body:['Cloudcode was mostly built as a functional example for my <a href="https://github.com/rclarey/simple-ot">operational transform library</a>, however it <i>is</i> useful for quickly creating a shareable document that can be collaboratively edited, for a video call with your team for example.',"<b>WARNING:</b> documents are only stored in memory on the server, so there is no guarantee that they will be persisted once all clients disconnect. Do not rely on Cloudcode to persist your documents."],confirm:"Create a new document",onConfirm:function(){return p(t,void 0,void 0,regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=h.genId(),location.search="doc=".concat(e),y.default(e);case 3:case"end":return t.stop()}},t)}))}})}m();
},{"./editor":"bkb9","./modal":"DILy","./util":"BHXf"}]},{},["ZCfc"], null)
//# sourceMappingURL=/__/dist/.map